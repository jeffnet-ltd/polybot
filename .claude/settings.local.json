{
  "permissions": {
    "allow": [
      "Bash(git add:*)",
      "Bash(tree:*)",
      "Bash(find:*)",
      "Bash(wc:*)",
      "Bash(git commit:*)",
      "Bash(docker exec:*)",
      "Bash(docker logs:*)",
      "Bash(docker-compose down:*)",
      "Bash(docker-compose up:*)",
      "Bash(docker ps:*)",
      "Bash(docker-compose ps:*)",
      "Bash(curl:*)",
      "Bash(npm run build:*)",
      "Bash(grep:*)",
      "Bash(docker-compose logs:*)",
      "Bash(docker-compose build:*)",
      "Bash(timeout 30 docker-compose logs:*)",
      "Bash(node -c:*)",
      "Bash(docker-compose kill:*)",
      "Bash(ls -la \"d:\\PolyBot\\polybot\\frontend\\public\\images\"\" 2>/dev/null || echo \"Directory does not exist yet \")",
      "Bash(dir:*)",
      "Bash(findstr:*)",
      "Bash(python:*)",
      "Bash(cd:*)",
      "Bash(git commit -m \"$(cat <<''EOF''\nv2.1.0: Remove Edge TTS, Azure Primary, Implement Gendered Character Voices\n\n## Summary\nComplete removal of Edge-TTS and promotion of Azure Speech Services as the sole,\nreliable TTS provider. Implements character-aware gendered voice selection for\nenhanced learner immersion.\n\n## Major Changes\n\n### 1. Edge TTS Removal (Completed)\n- Removed edge-tts dependency from requirements.txt\n- Deleted Edge-TTS imports and availability checks from server.py\n- Removed get_edge_tts_voice() function (replaced by character-based selection)\n- Removed diagnostic endpoints: /api/v1/voice/tts-info, /api/v1/voice/test-tts\n- Deleted test files: backend/test_tts.py, backend/scripts/generate_audio.py\n- Simplified TTS architecture (no fallback logic needed)\n\n### 2. Azure Speech Services - Primary TTS Provider\n- Azure Speech Services is now the sole TTS provider\n- Updated synthesize_azure_speech() to accept character_name parameter\n- Updated synthesize_tts() wrapper with character support\n- Updated all 3 endpoints: /api/v1/voice/synthesize, /api/v1/voice/chat, /api/practice/voice-chat\n- Performance improvement: 1-5 second latency reduction (no Edge-TTS timeout attempts)\n\n### 3. Gendered Character Voice Support (NEW)\n- Created backend/character_voices.py with character-gender mapping\n- Character mapping: Sofia/Maria/Luisa/Anna (Female), Marco/Luca/John (Male)\n- High-quality Azure Neural voice pairs for 8 languages:\n  * English: GuyNeural (M) / JennyNeural (F)\n  * Italian: DiegoNeural (M) / ElsaNeural (F)\n  * French: HenriNeural (M) / DeniseNeural (F)\n  * Spanish: AlvaroNeural (M) / ElviraNeural (F)\n  * Portuguese: AntonioNeural (M) / FranciscaNeural (F)\n  * German: ConradNeural (M) / KatjaNeural (F)\n  * Japanese: KeitaNeural (M) / NanamiNeural (F)\n  * Chinese: YunxiNeural (M) / XiaoxiaoNeural (F)\n- Automatic character extraction from dialogue text (e.g., \"Marco: Ciao!\" â†’ Marco)\n- Gender-specific voice selection per character\n\n### 4. Updated Documentation\n- Created v2.1.0 Project Context file with all changes documented\n- Updated roadmap to confirm Azure as definitive TTS solution\n- Marked TTS high availability as completed task\n\n## Technical Details\n- character_voices.py provides get_voice_for_character(lang_code, character_name)\n- extract_character_name(text) parses dialogue prefixes automatically\n- System responses (Polybot AI) use default female voice for consistency\n- Easy character expansion: add to CHARACTER_GENDERS dictionary, system auto-detects\n\n## Performance Impact\n- TTS response time: 2-3 seconds (previously 3-8s with Edge-TTS fallback)\n- No DNS instability issues (Azure is containerization-friendly)\n- 99.9% SLA uptime reliability\n\n## Files Modified\n- backend/server.py: Removed Edge-TTS code, updated TTS functions\n- backend/requirements.txt: Removed edge-tts dependency\n- backend/character_voices.py: [NEW] Character voice configuration\n- frontend/src/utils/audio.js: Updated comments\n- context-docs/project-docs/2.1.0 Project Context: [NEW] Updated documentation\n\nðŸ¤– Generated with [Claude Code](https://claude.com/claude-code)\n\nCo-Authored-By: Claude Haiku 4.5 <noreply@anthropic.com>\nEOF\n)\")"
    ]
  }
}
