**Version:** 1.0.6 (MVP Stable - Persistence & AI Live) **Status:** Development - Implementing Curriculum Data **Last Updated:** 2025-11-26 **Dev Environment:** HP EliteBook 820 G4, Ubuntu 24.04.3 LTS

## Executive Summary

Polybot is an **AI-powered multilingual language learning platform** that runs entirely locally using the open-source BLOOM language model. It provides structured conversational practice based on the **CEFR (Common European Framework of Reference for Languages)** curriculum, offering complete privacy and zero API costs.

**Key Differentiator:** True bilingual learning - users learn in their target language while receiving explanations in their native language.

**Current Status:** The core infrastructure (Frontend, Backend, DB) is stable. User registration and login are fully persistent. The AI model loads in the background without blocking container startup.

## Project Vision: CEFR Curriculum

**Primary Goal:** Create an accessible, private, and cost-free language learning tool that guides learners through the CEFR framework. **Curriculum Scope:** Initial focus on **A1 (Beginner)** modules (Greetings, Verb "To Be", Numbers, etc.). **Assessment:** AI replaces human review for targeted practice of specific grammar points defined in the lesson plan.

## Technical Architecture

### Stack Overview

```
Frontend: React 18.2.0 + Tailwind CSS + Lucide React
Backend: FastAPI (Python 3.11) + BLOOM AI (Local)
Database: MongoDB 7.0
Infrastructure: Docker + Docker Compose (V2)
AI Model: BLOOM 560m (Loaded in background task)
```

### System Architecture

```
┌─────────────┐      ┌─────────────┐      ┌─────────────┐
│   React     │────▶│   FastAPI   │────▶│   MongoDB   │
│  Frontend   │      │   Backend   │      │   Database  │
│  Port 3000  │      │  Port 8000  │      │ Port 27017  │
└─────────────┘      └─────────────┘      └─────────────┘
                            │
                            ▼
                     ┌─────────────┐
                     │ BLOOM Model │
                     │ (Local AI)  │
                     └─────────────┘
```

### Networking (Docker)

- **Network:** `polybot_network` (Bridge driver)
    
- **Service Discovery:**
    
    - Frontend talks to Backend via `http://backend:8000` (Server-side rendering context)
        
    - Browser talks to Backend via `http://localhost:8000` (Client-side context)
        
    - Backend talks to Database via `mongodb://mongodb:27017`
        

## Update Log (Recent Critical Sessions)

**Session: Startup Optimization & Final Stability**

- **Fix:** Implemented **Background Model Loading** in `server.py` to unblock port 8000 immediately upon startup.
    
- **Fix:** Removed `pip install` from `docker-compose.yml` runtime command to reduce boot time by 3-5 minutes.
    
- **Fix:** Wiped database volume (`docker compose down -v`) to resolve schema mismatch errors (`native_lang` vs `native_language`).
    
- **Status:** Registration and Login flows are verified working. AI Inference is live.
    

**Session: CEFR & Persistence Update**

- **Pivot:** Shifted from "Free Chat" to structured "Curriculum View".
    
- **Frontend:** Refactored `App.jsx` to `Sidebar` layout; added 15s Axios timeout.
    
- **Backend:** Implemented `Motor` (Async MongoDB) connection and Pydantic schemas (`UserProfile`).
    

## Current Critical Issues

- **Content Gap:** The "Lessons" tab in the frontend is currently hardcoded. It needs to pull the actual A1 curriculum from the database.
    
- **AI Context:** The Tutor mode currently uses a generic prompt. It needs to be updated to accept a `lesson_id` context to provide lesson-specific feedback.
    

## File Structure (Current)

```
polybot/
├── .env                      # Global config (MONGO_URL, etc.)
├── polybot_curriculum_a1.md  # Curriculum definition (Markdown source)
├── docker-compose.yml        # V2 Syntax, Optimized Startup
├── backend/
│   ├── server.py             # FastAPI + MongoDB + BLOOM Logic (Background Loader)
│   ├── requirements.txt
│   └── Dockerfile            # Python 3.11 Slim
├── frontend/
│   ├── package.json          # React 18.2.0 + Axios
│   ├── Dockerfile            # Node 18 Alpine
│   ├── public/
│   │   └── index.html
│   └── src/
│       ├── index.js
│       ├── index.css
│       └── App.jsx           # Main App Logic (Registration + Chat + Curriculum)
```

## Next Steps (Prioritized)

1. **Seed Curriculum Data:** Create a startup script in `server.py` to parse `polybot_curriculum_a1.md` (or a JSON equivalent) and populate the `lessons` collection in MongoDB if empty.
    
2. **Serve Lessons:** Create a `GET /lessons` endpoint in `server.py`.
    
3. **Connect Frontend:** Update `App.jsx` to fetch the lesson list dynamically and pass the `lesson_id` to the chat interface.
    
4. **Contextual AI:** Update the `generate_bloom_response` prompt to include the specific grammar rules of the active lesson.