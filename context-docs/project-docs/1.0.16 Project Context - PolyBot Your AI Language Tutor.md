Version: 1.0.17 (Stable, Verified, & Tested)

Status: Production Ready - Core Features Complete + Module A1.1 Enhanced with New Exercise Types

Last Updated: 2025-01-XX (Updated with Enhanced Exercise Types, Self-Assessment, and Improved Listening Comprehension)

Dev Environment: HP EliteBook 820 G4 / Windows 11 WSL2 (NVIDIA RTX 2080 Ti - Docker Desktop with GPU Support) $\rightarrow$ **Migrating to RunPod Serverless GPU**

## Executive Summary

Polybot is an **AI-powered multilingual language learning platform** that runs entirely locally $\rightarrow$ **Migrating to a Serverless Cloud Architecture for scalability and global deployment.** It combines a structured **10-module CEFR A1 Curriculum** with free-flowing AI roleplay to provide a "True Bilingual" learning experience.

**Key Differentiator:** Users learn in their target language while receiving explanations in their native language. The architecture ensures total privacy and zero latency through local LLM use, which will be maintained in the cloud via **Serverless GPU Scaling**.

**Current Status:** Module A1.1 (Greetings & Introductions) is fully implemented with 9 lessons (including self-assessment), comprehensive exercise types including new listening, reading, and writing exercises, and a static Boss Fight system. Enhanced feedback mechanisms, voice integration (Whisper STT), and TTS-based listening comprehension are operational.

---

## Technical Architecture (V2.0 Target)

### Stack Overview

- **Frontend:** React 18.2.0 + Tailwind CSS + Lucide React
    
    - **Deployment:** **Vercel / Netlify** (Free Tier)
        
- **Backend:** FastAPI (Python 3.11) + **Llama 3 8B Instruct**
    
    - **Deployment:** **RunPod Serverless GPU** (Flex Workers for cost-efficiency)
        
- **Auth:** Google OAuth 2.0 (via `authlib`) + Local Session Management
    
- **Database:** MongoDB 7.0 $\rightarrow$ **MongoDB Atlas (Free Tier)**
    
- **Testing:** `pytest` suite with `AsyncMock` for backend logic verification.
    
- **Infrastructure:** Docker + Docker Compose (V2) - **Migrating to Serverless Endpoints.**

### Voice Integration (Implemented & Planned)

|**Component**|**Status**|**Model**|**Technical Justification**|
|---|---|---|---|
|**Speech-to-Text (STT)**|**âœ… Implemented**|**Whisper (OpenAI)**|Integrated for Echo Chamber exercises and Boss Fight voice input. Provides accurate transcription for pronunciation feedback.|
|**Text-to-Speech (TTS)**|**âœ… Implemented (Current)**|**Edge-TTS (Microsoft)**|Currently used for audio playback of vocabulary and phrases. Provides high-quality, natural-sounding synthesis.|
|**Text-to-Speech (TTS)**|**ðŸ”„ Planned (V2.0)**|**XTTS-v2 (Coqui)**|Free and open-source solution that provides **high-quality, expressive, multilingual synthesis**. Enables **zero-shot voice cloning** from a 6-second audio clip for a consistent AI Tutor voice across all target languages.|

### Hardware Requirement

- **AI Model:** Llama 3 8B Instruct will be hosted on **RunPod Serverless GPUs** (e.g., A40, L40S, or RTX 4090) using Docker containers.
    
- **Load Management:** **Model Ducking (VRAM Swapping)** and potential **4/8-bit Quantization** will be implemented to efficiently manage the concurrent VRAM load of Llama 3 and the Voice models (Whisper/XTTS-v2) on the shared GPU instance.

---

## Implemented Features (v1.0.16)

### Module A1.1: Greetings & Introductions

**Status:** âœ… Fully Implemented with Enhanced Exercise Types

- **9 Complete Lessons:**
    0. Self-Assessment: Greetings & Introductions (NEW)
    1. The Informal Zone (Friends & Peers)
    2. Formal Greetings & Time-Based Expressions
    3. Introducing Yourself (Pronunciation & Verbs)
    4. Polite Expressions & Closings
    5. Subject Pronouns & The Verb 'To Be'
    6. Introduction to Nouns
    7. Where Are You From? (Countries & Nationalities)
    8. Conversation Practice: Meeting a Neighbor - Informal & Formal (Boss Fight)

- **Grammar Coverage:**
    - Subject Pronouns (Io, Tu, Lui, Lei)
    - Verb "To Be" (Essere) - Present Simple conjugations
    - Nouns - Gender (Masculine/Feminine) and Articles (Un/Una, Il/La)
    - Asking about origin: "Di dove sei?" / "Di dove Ã¨?"
    - Countries and Nationalities: Italia, Francia, Spagna, Stati Uniti, Regno Unito / italiano/a, francese, spagnolo/a, americano/a, inglese

### Exercise Types Implemented

|**Exercise Type**|**Status**|**Features**|
|---|---|---|
|**Info Cards**|âœ… Complete|Audio playback (Edge-TTS), vocabulary introduction, grammar explanations, cultural notes support|
|**Match Pairs**|âœ… Complete|Audio-to-text matching, Italian-English word pairs, interactive selection, state reset on exercise change, improved click handlers, vocabulary review mode|
|**Unscramble**|âœ… Complete|Drag-and-drop sentence construction, word order practice, comma normalization, common mistakes detection with enhanced feedback|
|**Echo Chamber**|âœ… Complete|Voice recording (MediaRecorder API), Whisper STT transcription, phonetic scoring (Levenshtein distance), playback before submission|
|**Mini-Prompt**|âœ… Complete|Contextual exercises, AI validation with fallback logic, context-specific feedback, accent detection (Italian), "almost" state for partial correctness, extension activities support|
|**Fill Blank**|âœ… Complete|Multiple choice fill-in-the-blank exercises|
|**Multiple Choice**|âœ… Complete|Standard multiple choice questions|
|**Gender Categorize**|âœ… Complete|Drag-and-drop noun gender classification (Maschile/Femminile), visual column layout|
|**Listening Comprehension**|âœ… Complete (NEW)|TTS-based audio playback with hidden sentences, multiple choice questions, replay functionality (up to max_plays), auto-play on mount|
|**Reading Comprehension**|âœ… Complete (NEW)|Text-based comprehension exercises with highlighted vocabulary, multiple choice questions, context-aware explanations|
|**Free Writing**|âœ… Complete (NEW)|Open-ended writing tasks with AI validation, required elements checking, example responses, context-based prompts|
|**Form Fill**|âœ… Complete (NEW)|Interactive form completion exercises with multiple field types (text, select), validation rules, hints|
|**Self-Assessment**|âœ… Complete (NEW)|Confidence-based assessment questions, skip option, no scoring, custom completion screen|
|**Boss Fight**|âœ… Complete|Static 2-round conversation system (Informal/Formal), hints tracking, grammar/spelling feedback, round transition controls|

### Enhanced Feedback System

- **Pedagogically-Focused Messages:** All exercises provide detailed explanations for correct/incorrect answers
- **"Almost" State:** Amber/warning feedback for partially correct answers (e.g., wrong accent, missing polite phrase)
- **Context-Specific Validation:** Mini-Prompt exercises use intelligent validation based on context (greetings, introductions, ordering, etc.)
- **Accent Detection:** Italian exercises detect and provide feedback on accent errors (Ã¨ vs Ã©)
- **Common Mistakes Detection:** Unscramble exercises now include pattern-based common mistakes detection with specific feedback messages
- **Cultural Notes:** Info cards support cultural note mode with enhanced styling and contextual information
- **Vocabulary Review:** Match exercises support review mode for vocabulary recycling
- **Extension Activities:** Optional challenge exercises for advanced learners with skip functionality

### UI/UX Enhancements

- **Accented Letter Chips:** Clickable accented letters (Ã , Ã¨, Ã©, Ã¬, Ã², Ã¹) for Italian input in text fields
- **Fade Animations:** Smooth transitions between Boss Fight rounds
- **Progress Tracking:** Visual progress bars and score tracking
- **Hints System:** Real-time word/phrase tracking in Boss Fight with dynamic instruction text
- **Custom Completion Screens:** Self-assessment lessons show custom completion message without score display
- **Consistent Navigation:** All lessons use "Continue to Next Lesson" button for consistent user flow
- **TTS Error Handling:** Graceful fallback to TTS when audio files are unavailable, with user-friendly error messages

### Voice Integration (Current)

- **Whisper STT:** Integrated for Echo Chamber and Boss Fight voice input
- **Edge-TTS:** Currently used for all audio playback, vocabulary pronunciation, and listening comprehension exercises
- **TTS-Based Listening:** Listening comprehension exercises use TTS to read hidden sentences (not displayed to user) with replay functionality
- **Audio Recording:** Browser MediaRecorder API with playback controls
- **Pronunciation Feedback:** Phonetic scoring using Levenshtein distance algorithm
- **Error Handling:** Automatic TTS fallback when audio files fail to load, ensuring exercises remain functional

---

## Roadmap: Next Steps (Priority)

1. **Voice Integration Enhancement (Priority):**
    
    - Migrate from Edge-TTS to **XTTS-v2** for AI Audio Output (TTS) with voice cloning capability.
        
    - Implement GPU Load Management strategy (Model Ducking/Quantization) in the FastAPI backend.
        
2. **Module A1.2 Implementation:** Begin development of "Personal Information & Family" module following the same exercise structure and learning loop.
    
3. **Core Curriculum Review:** Ensure all **10-Module A1 Course** content is pedagogically correct and complete before migration.
    
4. **Cloud Migration ("The Hub"):**
    
    - **Backend:** Deploy Dockerized FastAPI to **RunPod Serverless GPU**.
        
    - **Database:** Migrate local MongoDB to **MongoDB Atlas (Free Tier)**.
        
    - **Frontend:** Deploy React app to **Vercel/Netlify**.
        
5. **Mobile App Conversion:** Package the React frontend into a native container using **Capacitor**.
    
    - Use `npx cap add android` and `npx cap add ios` to create native projects pointing to the cloud backend (The Hub).
        
6. **Code Cleanup:** Resolve Pydantic V2 and FastAPI `lifespan` deprecation warnings identified during testing.

---

## Technical Notes

### Data Structure

- **Module Data:** Structured in `backend/a1_1_module_data.py` with hierarchical lesson/exercise organization
- **Exercise Validation:** Context-aware validation logic in `frontend/src/App.jsx` with fallback mechanisms
- **Boss Fight:** Static conversation flow with hard-coded messages and validation rules
- **New Exercise Fields:** 
  - `audio_text`: Hidden sentence for listening comprehension (read by TTS, not displayed)
  - `common_mistakes`: Array of pattern-based mistake detection with explanations
  - `review`: Boolean flag for vocabulary review exercises
  - `extension`: Boolean flag for optional extension activities
  - `cultural_note`: Boolean flag for cultural information cards
  - `required_elements`: Array for free writing validation
  - `form_fields`: Array of field definitions for form fill exercises

### Key Files

- `frontend/src/App.jsx` - Main React application with all exercise components
- `backend/server.py` - FastAPI backend with lesson endpoints and voice processing
- `backend/a1_1_module_data.py` - Module A1.1 structured data
- `context-docs/course-docs/The PolyBot A1 Curriculum Master Reference.md` - Curriculum reference

